# 時間管理パラメータチューニング計画

## 概要

時間管理モジュールの実装は完了しましたが、最適なパフォーマンスを実現するために、自己対局によるパラメータチューニングが必要です。

## チューニング対象パラメータ

### 1. 時間配分係数
- `soft_multiplier` (現在: 1.0) - ソフトリミットの基本倍率
- `hard_multiplier` (現在: 4.0) - ハードリミットの倍率
- `increment_usage` (現在: 0.8) - 増分時間の使用率

### 2. 局面係数
- `opening_factor` (現在: 1.2) - 序盤の時間配分倍率
- `endgame_factor` (現在: 0.8) - 終盤の時間配分倍率

### 3. PV安定性パラメータ
- `pv_base_threshold_ms` (現在: 80) - PV安定判定の基本閾値
- `pv_depth_slope_ms` (現在: 5) - 深さによる閾値増加率

### 4. 緊急停止閾値
- `critical_fischer_ms` (現在: 300) - Fischer制御での危険時間
- `critical_byoyomi_ms` (現在: 80) - 秒読みでの危険時間

## チューニング方法

### 1. 自己対局による評価
```bash
# 異なるパラメータセットでの対局
cargo run --bin self_play_tuning -- \
  --games 100 \
  --time-control "fischer 300000 5000" \
  --param-sets "baseline,aggressive,conservative"
```

### 2. 評価指標
- 勝率
- 時間切れ率
- 平均思考時間の分布
- 序盤・中盤・終盤での時間使用パターン

### 3. パラメータセット例

#### Baseline (現在のデフォルト)
```rust
TimeParameters {
    soft_multiplier: 1.0,
    hard_multiplier: 4.0,
    increment_usage: 0.8,
    opening_factor: 1.2,
    endgame_factor: 0.8,
    ..Default::default()
}
```

#### Aggressive (より多くの時間を使用)
```rust
TimeParameters {
    soft_multiplier: 1.5,
    hard_multiplier: 6.0,
    increment_usage: 0.9,
    opening_factor: 1.5,
    endgame_factor: 0.7,
    ..Default::default()
}
```

#### Conservative (時間を節約)
```rust
TimeParameters {
    soft_multiplier: 0.8,
    hard_multiplier: 3.0,
    increment_usage: 0.7,
    opening_factor: 1.0,
    endgame_factor: 0.9,
    ..Default::default()
}
```

## 実装タスク

1. [ ] 自己対局フレームワークの作成
2. [ ] パラメータセットの管理システム
3. [ ] 対局結果の統計収集
4. [ ] 最適パラメータの決定
5. [ ] デフォルトパラメータの更新

## 期待される成果

- 時間切れ率を1%未満に抑制
- 各局面での適切な時間配分
- 異なる時間制御での安定した性能
- プロ棋士の時間使用パターンに近い挙動

## 注意事項

- チューニングは計算リソースを大量に消費するため、クラウドコンピューティングの使用を推奨
- 異なる時間制御（Fischer、秒読み）で別々にチューニングが必要
- 将来的には機械学習による動的パラメータ調整も検討